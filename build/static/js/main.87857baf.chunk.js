(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{169:function(e,t,a){e.exports=a(315)},174:function(e,t,a){},175:function(e,t,a){},201:function(e,t){},203:function(e,t){},217:function(e,t){},219:function(e,t){},247:function(e,t){},249:function(e,t){},250:function(e,t){},256:function(e,t){},258:function(e,t){},276:function(e,t){},279:function(e,t){},295:function(e,t){},298:function(e,t){},315:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(58),c=a.n(o),l=(a(174),a(175),a(5)),s=a(16),m=a(6),u=a.n(m),i=(a(97),a(342)),p=a(85),d=a.n(p),f=a(157),E=a.n(f),b=a(335),g=a(341),h=a(337),y=a(338),O=a(339),v=a(340),N=a(65),j=a(64),S=a(159),_=a.n(S),C=a(160),x=a.n(C),T=a(158),k=a.n(T),P=Object(b.a)((function(e){return{root:{maxWidth:345},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},avatar:{backgroundColor:j.a[500]},small:{width:e.spacing(3),height:e.spacing(3)}}}));var I=Object(s.b)((function(e){return{post:e.post,user:e.auth}}),{fetchPost:function(){return function(e){u.a.get("/posts/getall").then((function(t){e({type:"FETCH_POSTS",payload:{post:t.data.post}})})).catch((function(e){return console.log(e)}))}},likes:function(e){return function(t){u.a.put("/posts/like/"+e).then((function(e){console.log(e.data),t({type:"FETCH_LIKE",payload:e.data})})).catch((function(e){return console.log(e)}))}},unlikes:function(e){return function(t){u.a.put("/posts/unlike/"+e).then((function(e){console.log(e.data),t({type:"FETCH_LIKE",payload:e.data})})).catch((function(e){return console.log(e)}))}},deletePost:function(e){return function(t){u.a.delete("/posts/delete/"+e).then((function(e){t({type:"DELETE_POST",payload:e.data})})).catch((function(e){return console.log(e)}))}},comment:function(e,t){return function(a){u.a.put("/posts/comment/"+e,t).then((function(e){console.log(e.data),a({type:"FETCH_LIKE",payload:e.data})})).catch((function(e){return console.log(e)}))}},deletecomment:function(e,t){return function(a){u.a.patch("/posts/comment/delete/".concat(e,"/").concat(t)).then((function(t){console.log(t),a({type:"FETCH_COMMENT",payload:{postId:e,commentArray:t.data}})})).catch((function(e){return console.log(e)}))}}})((function(e){d.a.extend(E.a);var t=P(),a=Object(n.useState)([]),o=Object(l.a)(a,2),c=o[0],s=o[1],m=Object(n.useState)(""),u=Object(l.a)(m,2),p=u[0],f=u[1],b=Object(n.useState)(""),j=Object(l.a)(b,2),S=j[0],C=j[1],T=e.fetchPost;Object(n.useEffect)((function(){T()}),[]);var I=e.post.post;return Object(n.useEffect)((function(){s(I)}),[I]),Object(n.useEffect)((function(){f(e.user.user._id),console.log(e.user.user._id)}),[e.user.user._id]),r.a.createElement("div",{className:"container mt-5"},c.length>0?c.map((function(a){return r.a.createElement("div",{className:"my-3"},r.a.createElement(g.a,{className:t.root},r.a.createElement(h.a,{avatar:r.a.createElement(v.a,{alt:"Cindy Baker",src:a.postedBy.profile}),action:a.postedBy._id===p?r.a.createElement(k.a,{className:"text-danger",onClick:function(){return e.deletePost(a._id)}}):null,title:a.postedBy.name,subheader:d()(a.date).fromNow()}),"no photo"!==a.photo?r.a.createElement("img",{src:a.photo,className:"card-image-top postimg"}):null,r.a.createElement(y.a,null,r.a.createElement(N.a,{variant:"body2",color:"textSecondary",component:"p"},a.title,r.a.createElement("br",null),a.body)),r.a.createElement(O.a,{style:{borderTop:"solid #dedede 1px",borderBottom:"solid #dedede 1px",marginBottom:"5px",padding:"10px 0"},disableSpacing:!0},a.likes.includes(p)?r.a.createElement(_.a,{className:"text-danger ml-2",onClick:function(){return e.unlikes(a._id)}}):r.a.createElement(x.a,{className:"ml-2",onClick:function(){return e.likes(a._id)}}),r.a.createElement("span",{className:"mx-2"},a.likes.length)),a.comment.map((function(n){return r.a.createElement("p",{key:n._id,className:"comment ml-2 mt-2"},r.a.createElement(v.a,{alt:"Cindy Baker",src:n.user.profile,className:t.small}),r.a.createElement("strong",{style:{margin:"0 5px"}},n.user.name)," ",n.commentBody,n.user._id===p?r.a.createElement("span",{className:"comment__delete"},r.a.createElement("i",{onClick:function(){return e.deletecomment(a._id,n._id)},className:"fa fa-trash"})):null)})),r.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.comment(a._id,{commentBody:S}),C(""),document.getElementById("comment").value=""}},r.a.createElement("div",{className:"comment"},r.a.createElement("input",{autoComplete:"off",placeholder:"add a comment",className:"form-control form-control-sm ml-2",id:"comment",type:"text",onChange:function(e){return C(e.target.value)}}),r.a.createElement("button",{className:"btn ml-0",type:"submit"}," ",r.a.createElement("i",{className:"fa fa-send text-success"}))))))})):r.a.createElement(r.a.Fragment,null,r.a.createElement(i.a,{animation:"border"})))})),w=a(8),R=function(){return function(e){u.a.get("/users/profile").then((function(t){e({type:"FETCH_PROFILEIMG",payload:t.data.profile})})).catch((function(e){return console.log(e)}))}},F=a(30),L=a(162),H=a(9),B={user:{},profileImg:"",error:{login:{},register:{}},isAuthenticated:!1};var A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REGISTER_USER":return Object(H.a)(Object(H.a)({},e),{},{error:Object(H.a)(Object(H.a)({},e.error),{},{register:t.payload})});case"LOGIN_USER":return{user:t.payload.user,error:Object(H.a)(Object(H.a)({},e.error),{},{login:t.payload.error}),isAuthenticated:0!==Object.keys(t.payload.user).length};case"FETCH_PROFILE":return Object(H.a)(Object(H.a)({},e),{},{user:t.payload,isAuthenticated:0!==Object.keys(t.payload).length});case"LOG_OUT":return{user:{},error:{login:{},register:{}},isAuthenticated:!1};case"FETCH_PROFILEIMG":return Object(H.a)(Object(H.a)({},e),{},{profileImg:t.payload});default:return e}},G=a(164),D={post:[],mypost:[],error:{}};var M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_POSTS":return Object(H.a)(Object(H.a)({},e),{},{post:Object(G.a)(t.payload.post),error:{}});case"MY_POST":return Object(H.a)(Object(H.a)({},e),{},{mypost:t.payload});case"POST_ERROR":return Object(H.a)(Object(H.a)({},e),{},{error:t.payload});case"FETCH_LIKE":var a=e.post.findIndex((function(e){return e._id===t.payload._id}));return e.post[a]=t.payload,Object(H.a)({},e);case"DELETE_POST":var n=e.post.findIndex((function(e){return e._id===t.payload._id}));return e.post.splice(n,1),Object(H.a)({},e);case"FETCH_COMMENT":var r=e.post.findIndex((function(e){return e._id===t.payload.postId}));return e.post[r].comment=t.payload.commentArray,Object(H.a)({},e);default:return e}},U=Object(F.c)({auth:A,post:M}),z=[L.a],K=Object(F.e)(U,Object(F.d)(F.a.apply(void 0,z)));var W=Object(s.b)((function(e){return{user:e.auth,post:e.post}}),{fetchProfile:R,mypost:function(){return function(e){u.a.get("/posts/mypost").then((function(t){e({type:"MY_POST",payload:t.data.post})})).catch((function(e){return console.log(e)}))}}})((function(e){var t=Object(n.useState)(""),a=Object(l.a)(t,2),o=a[0],c=a[1],s=Object(n.useState)(""),m=Object(l.a)(s,2),p=m[0],d=m[1],f=Object(n.useState)(!1),E=Object(l.a)(f,2),b=E[0],g=E[1],h=Object(n.useState)(""),y=Object(l.a)(h,2),O=y[0],v=y[1],N=Object(n.useState)(""),j=Object(l.a)(N,2),S=j[0],_=j[1],C=Object(n.useState)(""),x=Object(l.a)(C,2),T=x[0],k=x[1];Object(n.useEffect)((function(){setTimeout((function(){k("")}),2e3)}),[T]),Object(n.useEffect)((function(){v(e.user.profileImg)}),[e.user.profileImg]),Object(n.useEffect)((function(){c(e.user.user.name),d(e.user.user.email),g(!!e.user.isAuthenticated)}),[e.user.user]);var P=Object(w.f)();return Object(n.useEffect)((function(){e.fetchProfile(),e.mypost()}),[]),r.a.createElement("div",{className:"container"},""!==T?r.a.createElement("p",{className:"text-danger"},T):null,r.a.createElement("div",{className:"row mt-5"},r.a.createElement("div",{className:"col-6"},r.a.createElement("img",{className:"imgh",src:O}),r.a.createElement("form",{encType:"multipart/form-data",method:"post",onSubmit:function(e){e.preventDefault();var t=new FormData;t.append("profile",S),u.a.put("/users/profile",t).then((function(e){k(e.data.message),e.data.success&&K.dispatch({type:"FETCH_PROFILEIMG",payload:e.data.user.profile})})).catch((function(e){return console.log(e)}))},className:"my-3"},r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"file",className:"form-control-file",name:"profile",onChange:function(e){_(e.target.files[0])}}),r.a.createElement("button",{type:"submit",className:"btn btn-primary my-3"},"Change Picture")))),r.a.createElement("div",{className:"col-6"},b?r.a.createElement("div",null,r.a.createElement("p",null,"name: ",o),r.a.createElement("p",null,"Email: ",p)):r.a.createElement("button",{onClick:function(){P.push("/login")}},"login"))),r.a.createElement("hr",null),e.post.mypost.length>0?e.post.mypost.map((function(e){return r.a.createElement("div",{key:e._id,className:"card my-3"},r.a.createElement("div",{className:"card-body"},"Posted By: ",r.a.createElement("strong",null,e.postedBy.name),"no photo"!==e.photo?r.a.createElement("img",{src:e.photo,className:"card-image-top postimg"}):null,r.a.createElement("h5",null,e.title),r.a.createElement("p",null,e.body)))})):r.a.createElement("p",null,"No posts found",r.a.createElement(i.a,{animation:"border"})))}));var J=Object(s.b)((function(e){return{user:e.auth}}),{login:function(e,t){return function(a){u.a.post("/users/login",e).then((function(e){var n=e.data;e.data.success?(localStorage.setItem("auth-token",n.token),a({type:"LOGIN_USER",payload:{user:e.data.user,error:{}}}),function(){var e=localStorage.getItem("auth-token");u.a.defaults.headers.common.Authorization=e||""}(),R(),t.push("/")):a({type:"LOGIN_USER",payload:{user:{},error:e.data}})})).catch((function(e){return console.log(e)}))}}})((function(e){var t=Object(n.useState)(""),a=Object(l.a)(t,2),o=a[0],c=a[1],s=Object(n.useState)(""),m=Object(l.a)(s,2),u=m[0],i=m[1],p=Object(n.useState)({}),d=Object(l.a)(p,2),f=d[0],E=d[1];return Object(n.useEffect)((function(){E(e.user.error.login)}),[e.user.error.login]),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-8 offset-md-2 card mt-5 p-3"},r.a.createElement("form",{onSubmit:function(t){t.preventDefault();var a={email:o,password:u};e.login(a,e.history)}},r.a.createElement("h1",{className:"display-4 text-center"},"Login Here"),null==f.message?null:r.a.createElement("p",{className:"text-danger"},f.message),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"email"),r.a.createElement("input",{onChange:function(e){return c(e.target.value)},type:"text",className:"form-control"}),null==f.email?null:r.a.createElement("p",{className:"text-danger"},f.email)),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Password"),r.a.createElement("input",{onChange:function(e){return i(e.target.value)},type:"password",className:"form-control"}),null==f.password?null:r.a.createElement("p",{className:"text-danger"},f.password)),r.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Login")))))}));var Y=Object(s.b)((function(e){return{user:e.auth}}),{register:function(e,t){return function(a){u.a.post("/users/register",e).then((function(e){a({type:"REGISTER_USER",payload:e.data}),"Register successfull"===e.data.message&&t.push("/login")})).catch((function(e){return console.log(e)}))}}})((function(e){var t=Object(n.useState)(""),a=Object(l.a)(t,2),o=a[0],c=a[1],s=Object(n.useState)(""),m=Object(l.a)(s,2),u=m[0],i=m[1],p=Object(n.useState)(""),d=Object(l.a)(p,2),f=d[0],E=d[1],b=Object(n.useState)(""),g=Object(l.a)(b,2),h=g[0],y=g[1],O=Object(n.useState)({}),v=Object(l.a)(O,2),N=v[0],j=v[1];return Object(n.useEffect)((function(){j(e.user.error.register)}),[e.user.error.register]),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-8 offset-md-2 card mt-5 p-3"},r.a.createElement("form",{onSubmit:function(t){t.preventDefault();var a={name:o,email:u,password:f,confirmPassword:h};e.register(a,e.history)}},r.a.createElement("h1",{className:"display-4 text-center"},"Register Here"),N.message&&r.a.createElement("p",{className:"text-danger"},N.message),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Name"),r.a.createElement("input",{onChange:function(e){return c(e.target.value)},type:"text",className:"form-control"}),r.a.createElement("p",{className:"text-danger"},N.name)),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"email"),r.a.createElement("input",{onChange:function(e){return i(e.target.value)},type:"text",className:"form-control"}),r.a.createElement("p",{className:"text-danger"},N.email)),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Password"),r.a.createElement("input",{onChange:function(e){return E(e.target.value)},type:"password",className:"form-control"}),r.a.createElement("p",{className:"text-danger"},N.password)),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Confirm Password"),r.a.createElement("input",{onChange:function(e){return y(e.target.value)},type:"password",className:"form-control"}),r.a.createElement("p",{className:"text-danger"},N.confirmPassword)),r.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Register")))))})),$=a(25);var q=Object(s.b)((function(e){return{user:e.auth}}))((function(e){var t=Object(w.f)();return r.a.createElement("nav",{className:"navbar navbar-expand navbar-dark bg-primary"},r.a.createElement($.b,{to:"/",className:"navbar-brand"},"Instagram"),r.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent"},r.a.createElement("ul",{className:"navbar-nav mr-auto"},!e.user.isAuthenticated&&r.a.createElement(r.a.Fragment,null,r.a.createElement("li",{className:"nav-item"},r.a.createElement($.b,{className:"nav-link mr-0",to:"/login"},"Login")),r.a.createElement("li",{className:"nav-item"},r.a.createElement($.b,{className:"nav-link mr-0",to:"/register"},"Register"))),e.user.isAuthenticated&&r.a.createElement(r.a.Fragment,null,r.a.createElement("li",{className:"nav-item "},r.a.createElement($.b,{className:"nav-link ",to:"/profile"},"Profile")),r.a.createElement("li",{className:"nav-item "},r.a.createElement($.b,{className:"nav-link ",to:"/post"},"Create Post")),r.a.createElement("li",{className:"nav-item"},r.a.createElement("button",{onClick:function(){localStorage.clear(),t.push("/login"),K.dispatch({type:"LOG_OUT"}),u.a.defaults.headers.common.Authorization=""},className:"btn btn-danger btn-sm",to:"/register"},"Logout"))))))}));var Q=Object(s.b)((function(e){return{post:e.post}}),{submitPost:function(e,t){return function(a){u.a.post("/posts/create",e).then((function(e){e.data.success?(a({type:"FETCH_POSTS",payload:{post:[e.data.post]}}),t.push("/")):a({type:"POST_ERROR",payload:e.data})})).catch((function(e){return console.log(e)}))}}})((function(e){var t=Object(w.f)(),a=Object(n.useState)(""),o=Object(l.a)(a,2),c=o[0],s=o[1],m=Object(n.useState)(""),u=Object(l.a)(m,2),i=u[0],p=u[1],d=Object(n.useState)(""),f=Object(l.a)(d,2),E=f[0],b=f[1],g=Object(n.useState)({}),h=Object(l.a)(g,2),y=h[0],O=h[1];return Object(n.useEffect)((function(){O(e.post.error)}),[e.post.error]),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-8 offset-md-2 card mt-5 p-3"},r.a.createElement("form",{onSubmit:function(a){a.preventDefault();var n=new FormData;n.append("title",c),n.append("body",i),n.append("photo",E),e.submitPost(n,t)},encType:"multipart/form-data"},r.a.createElement("h1",{className:"display-4 text-center"},"Post"),r.a.createElement("p",{className:"text-danger"},y.message),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"title"),r.a.createElement("input",{name:"title",onChange:function(e){return s(e.target.value)},type:"text",className:"form-control"})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Body"),r.a.createElement("input",{name:"body",onChange:function(e){return p(e.target.value)},type:"text",className:"form-control"})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Photo"),r.a.createElement("input",{onChange:function(e){return b(e.target.files[0])},type:"file",name:"photo",className:"form-control-file"})),r.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Submit Post")))))}));var V=function(){return r.a.createElement($.a,null,r.a.createElement(q,null),r.a.createElement(w.c,null,r.a.createElement(w.a,{exact:!0,path:"/",component:I}),r.a.createElement(w.a,{path:"/profile",component:W}),r.a.createElement(w.a,{path:"/login",component:J}),r.a.createElement(w.a,{path:"/register",component:Y}),r.a.createElement(w.a,{path:"/post",component:Q})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var X=a(163),Z=a.n(X),ee=localStorage.getItem("auth-token");ee?Z.a.verify(ee,"SECRET",(function(e,t){if(void 0===t)return localStorage.clear();u.a.defaults.headers.common.Authorization=ee,u.a.get("/users/"+t._id).then((function(e){K.dispatch({type:"FETCH_PROFILE",payload:e.data})})).catch((function(e){return console.log(e)}))})):u.a.defaults.headers.common.Authorization="",c.a.render(r.a.createElement(s.a,{store:K},r.a.createElement(V,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[169,1,2]]]);
//# sourceMappingURL=main.87857baf.chunk.js.map